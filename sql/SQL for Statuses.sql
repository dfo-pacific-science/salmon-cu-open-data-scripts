--sql to generate wsp statuses, Run on PROD--

--Chinook--

SELECT
CU_NAME,
FULL_CU_IN,
SUBSTR(FULL_CU_IN, 1, 2) AS SP_QUAL,
LH_TYPE AS LIFE_HISTORY_TYPE,
SPECIES,
CU_TYPE,
WSP_RAPID_STATUS,
WSP_RAPID_CONFIDENCE,
CASE 
WHEN WSP_RAPID_STATUS IS NULL THEN NULL
ELSE WSP_RAPID_STATUS_YEAR
END AS WSP_RAPID_STATUS_YEAR,
INTEGRATED_STATUS,
INTEGRATED_STATUS_YEAR
FROM
CU_PROFILE_VW
WHERE
SPECIES='Chinook'
ORDER BY FULL_CU_IN ASC

--SBC Chinook--

SELECT
CU_NAME,
FULL_CU_IN,
SUBSTR(FULL_CU_IN, 1, 2) AS SP_QUAL,
LH_TYPE AS LIFE_HISTORY_TYPE,
SPECIES,
CU_TYPE,
WSP_RAPID_STATUS,
WSP_RAPID_CONFIDENCE,
CASE 
WHEN WSP_RAPID_STATUS IS NULL THEN NULL
ELSE WSP_RAPID_STATUS_YEAR
END AS WSP_RAPID_STATUS_YEAR,
INTEGRATED_STATUS,
INTEGRATED_STATUS_YEAR
FROM
CU_PROFILE_VW
WHERE
SPECIES='Chinook'
AND
FULL_CU_IN IN ('CK-01',
'CK-02',
'CK-03',
'CK-04',
'CK-05',
'CK-06',
'CK-07',
'CK-08',
'CK-09',
'CK-10',
'CK-11',
'CK-12',
'CK-13',
'CK-14',
'CK-15',
'CK-16',
'CK-17',
'CK-18',
'CK-19',
'CK-20',
'CK-21',
'CK-22',
'CK-25',
'CK-27',
'CK-28',
'CK-29',
'CK-31',
'CK-32',
'CK-33',
'CK-34',
'CK-35',
'CK-82',
'CK-83',
'CK-9005',
'CK-9008')
ORDER BY FULL_CU_IN ASC;

--Chum--

SELECT
CU_NAME,
FULL_CU_IN,
SUBSTR(FULL_CU_IN, 1, 2) AS SP_QUAL,
LH_TYPE AS LIFE_HISTORY_TYPE,
SPECIES,
CU_TYPE,
WSP_RAPID_STATUS,
WSP_RAPID_CONFIDENCE,
CASE 
WHEN WSP_RAPID_STATUS IS NULL THEN NULL
ELSE WSP_RAPID_STATUS_YEAR
END AS WSP_RAPID_STATUS_YEAR,
INTEGRATED_STATUS,
INTEGRATED_STATUS_YEAR
FROM
CU_PROFILE_VW
WHERE
SPECIES='Chum'
ORDER BY FULL_CU_IN ASC;

--Coho--

SELECT
CU_NAME,
FULL_CU_IN,
SUBSTR(FULL_CU_IN, 1, 2) AS SP_QUAL,
LH_TYPE AS LIFE_HISTORY_TYPE,
SPECIES,
CU_TYPE,
WSP_RAPID_STATUS,
WSP_RAPID_CONFIDENCE,
CASE 
WHEN WSP_RAPID_STATUS IS NULL THEN NULL
ELSE WSP_RAPID_STATUS_YEAR
END AS WSP_RAPID_STATUS_YEAR,
INTEGRATED_STATUS,
INTEGRATED_STATUS_YEAR
FROM
CU_PROFILE_VW
WHERE
SPECIES='Coho'
ORDER BY FULL_CU_IN ASC;

--Pink Even Year--

SELECT
CU_NAME,
FULL_CU_IN,
SUBSTR(FULL_CU_IN, 1, 3) AS SP_QUAL,
LH_TYPE AS LIFE_HISTORY_TYPE,
SPECIES,
CU_TYPE,
WSP_RAPID_STATUS,
WSP_RAPID_CONFIDENCE,
CASE 
WHEN WSP_RAPID_STATUS IS NULL THEN NULL
ELSE WSP_RAPID_STATUS_YEAR
END AS WSP_RAPID_STATUS_YEAR,
INTEGRATED_STATUS,
INTEGRATED_STATUS_YEAR
FROM
CU_PROFILE_VW
WHERE
SPECIES='Pink'
AND
LH_TYPE='Even Year'
ORDER BY FULL_CU_IN ASC;

--Pink Odd Year--

SELECT
CU_NAME,
FULL_CU_IN,
SUBSTR(FULL_CU_IN, 1, 3) AS SP_QUAL,
LH_TYPE AS LIFE_HISTORY_TYPE,
SPECIES,
CU_TYPE,
WSP_RAPID_STATUS,
WSP_RAPID_CONFIDENCE,
CASE 
WHEN WSP_RAPID_STATUS IS NULL THEN NULL
ELSE WSP_RAPID_STATUS_YEAR
END AS WSP_RAPID_STATUS_YEAR,
INTEGRATED_STATUS,
INTEGRATED_STATUS_YEAR
FROM
CU_PROFILE_VW
WHERE
SPECIES='Pink'
AND
LH_TYPE='Odd Year'
ORDER BY FULL_CU_IN ASC;

--Sockeye Lake Type--

SELECT
CU_NAME,
FULL_CU_IN,
SUBSTR(FULL_CU_IN, 1, 3) AS SP_QUAL,
LH_TYPE AS LIFE_HISTORY_TYPE,
SPECIES,
CU_TYPE,
WSP_RAPID_STATUS,
WSP_RAPID_CONFIDENCE,
CASE 
WHEN WSP_RAPID_STATUS IS NULL THEN NULL
ELSE WSP_RAPID_STATUS_YEAR
END AS WSP_RAPID_STATUS_YEAR,
INTEGRATED_STATUS,
INTEGRATED_STATUS_YEAR
FROM
CU_PROFILE_VW
WHERE
SPECIES='Sockeye'
AND
LH_TYPE='Lake Type'
ORDER BY FULL_CU_IN ASC;

--Sockeye River Type--

SELECT
CU_NAME,
FULL_CU_IN,
SUBSTR(FULL_CU_IN, 1, 3) AS SP_QUAL,
LH_TYPE AS LIFE_HISTORY_TYPE,
SPECIES,
CU_TYPE,
WSP_RAPID_STATUS,
WSP_RAPID_CONFIDENCE,
CASE 
WHEN WSP_RAPID_STATUS IS NULL THEN NULL
ELSE WSP_RAPID_STATUS_YEAR
END AS WSP_RAPID_STATUS_YEAR,
INTEGRATED_STATUS,
INTEGRATED_STATUS_YEAR
FROM
CU_PROFILE_VW
WHERE
SPECIES='Sockeye'
AND
LH_TYPE='River Type'
ORDER BY FULL_CU_IN ASC;


